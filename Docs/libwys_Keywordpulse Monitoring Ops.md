# 📡 운영 및 모니터링 전략 문서 (KeywordPulse)

이 문서는 KeywordPulse 서버리스 웹 애플리케이션의 안정적인 운영을 위한 모니터링, 로깅, 성능 관리, 알림 전략을 정의합니다.

---

## 🎯 운영 목적

- 서버리스 환경에서도 가시성 확보
- 오류 발생 시 즉각 인지 및 대응
- 성능 병목 및 사용자 이탈 요인 사전 식별

---

## 🔍 주요 운영 대상

| 영역    | 운영 항목                    | 설명                          |
| ----- | ------------------------ | --------------------------- |
| API   | 응답 시간, 오류율               | 5xx, 4xx 비율 추적, 평균 응답 시간 측정 |
| 프론트엔드 | JS 에러, 사용자 행동 로그         | 브라우저 오류, 분석 완료 전 이탈 등       |
| 외부 연동 | Google Sheets / Telegram | 외부 API 호출 실패율, 재시도 로직 포함    |
| 인증    | Supabase 토큰 검증 실패        | 권한 관련 오류 로그, 토큰 만료 응답 추적    |

---

## 📄 로깅 전략

### 1. 서버리스 API 로그 (Vercel Functions)

- 로그 위치: Vercel > Project > Functions > Logs
- 로그 수준: `info`, `warn`, `error`
- 로그 형식 예시:

```python
logger.info(f"[search] keyword='{keyword}' 캐시 사용 여부={cached}")
logger.error(f"[analyze] 분석 실패: {str(e)}")
```

- `print()`는 콘솔 출력 + Vercel 로그 연동됨

### 2. 프론트엔드 로그

- 브라우저 JS 에러: `window.onerror`, `console.error` 자동 캡처
- 사용자 이벤트 추적: Page View, 키워드 검색, 저장 버튼 클릭 등

---

## 📊 성능 모니터링 도구

| 도구                 | 역할                   | 적용 방법                        |                  |
| ------------------ | -------------------- | ---------------------------- | ---------------- |
|                    | **Vercel Analytics** | API 응답 시간, Request 수         | 기본 활성화 + 대시보드 제공 |
| **Sentry**         | 프론트 및 서버 오류 수집       | SDK 통합 + 실시간 알림 설정           |                  |
| **LogRocket (선택)** | 사용자 화면 재현 / UX 분석    | React + Session Record 기능 제공 |                  |

---

## 🚨 알림 시스템

| 항목         | 도구                      | 설명                   |
| ---------- | ----------------------- | -------------------- |
| 서버 오류 감지   | Sentry → Slack / Email  | Error 레벨 발생 시 즉시 알림  |
| API 실패율 증가 | Vercel Webhook + Zapier | 5xx 증가시 Slack DM 자동화 |
| 외부 API 실패  | Telegram Bot → 관리자 채널   | 수동 재시도 또는 대체 처리 유도   |

---

## 📈 성능 지표 (KPI)

| 항목             | 기준     | 목표                         |
| -------------- | ------ | -------------------------- |
| 평균 응답 시간       | < 1.0s | 90% 이상 응답 달성               |
| 오류율            | < 1%   | 5xx / 4xx 비율 제한            |
| 사용자 세션 이탈율     | < 10%  | 분석 완료 전 이탈 방지              |
| 전송 성공률 (알림/저장) | > 98%  | Telegram/Sheets API 연동 성공률 |

---

## 🔄 운영 자동화 체크리스트

| 작업               | 주기      | 방식                          |
| ---------------- | ------- | --------------------------- |
| 로그 점검            | 일 1회    | Sentry Dashboard 확인         |
| 캐시 무효화           | 24시간 주기 | TTL 정책 or Vercel Cron 사용    |
| 서버리스 함수 응답률 모니터링 | 실시간     | Vercel + Statuspage 통합 (선택) |
| CI 테스트 통과 여부 확인  | PR 마다   | GitHub Actions 배포 조건 설정     |

---

## 📚 운영 문서 및 대시보드

| 항목                     | 설명                           |
| ---------------------- | ---------------------------- |
| Sentry Error Dashboard | 오류 발생 시점 및 Stack Trace 확인 가능 |
| Vercel Analytics       | 각 함수별 호출 수, 오류 수, 응답 시간 시각화  |
| Google Sheets 로그 시트    | 저장 성공 내역 기록 (시간, 키워드, 사용자)   |

---

## ✨ 향후 확장 계획

- 사용자별 대시보드 제공 (개인별 키워드 기록, 사용 이력)
- 로그 기반 이상 탐지 모델 도입 (예: 불규칙한 API 패턴)
- 프론트엔드 사용자 행동 기반 A/B 테스트 분석 자동화

---

> 이 문서는 KeywordPulse 프로젝트의 운영 환경 안정성과 가시성을 확보하기 위한 실무 기준의 모니터링 및 로깅 전략을 담고 있습니다.

