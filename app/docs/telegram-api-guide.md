# ν…”λ κ·Έλ¨ μ•λ¦Ό API κ°€μ΄λ“

KeywordPulse μ• ν”λ¦¬μΌ€μ΄μ…μ ν…”λ κ·Έλ¨ μ•λ¦Ό κ΄€λ ¨ APIμ— λ€ν• κ°λ°μ κ°€μ΄λ“μ…λ‹λ‹¤. μ΄ λ¬Έμ„λ” ν…”λ κ·Έλ¨μ„ ν†µν•΄ ν‚¤μ›λ“ λ¶„μ„ κ²°κ³Ό λ° μ•λ¦Όμ„ μ „μ†΅ν•λ” λ°©λ²•μ„ μ„¤λ…ν•©λ‹λ‹¤.

## λ©μ°¨

1. [API μ—”λ“ν¬μΈνΈ κ°μ”](#1-api-μ—”λ“ν¬μΈνΈ-κ°μ”)
2. [ν…”λ κ·Έλ¨ ν…μ¤νΈ λ©”μ‹μ§€ API](#2-ν…”λ κ·Έλ¨-ν…μ¤νΈ-λ©”μ‹μ§€-api)
3. [ν‚¤μ›λ“ λ¶„μ„ μ•λ¦Ό API](#3-ν‚¤μ›λ“-λ¶„μ„-μ•λ¦Ό-api)
4. [RAG κΈ°λ° λ¶„μ„ μ•λ¦Ό API](#4-rag-κΈ°λ°-λ¶„μ„-μ•λ¦Ό-api)
5. [κΈ°λ³Έ μ•λ¦Ό API](#5-κΈ°λ³Έ-μ•λ¦Ό-api)
6. [μ¤λ¥ μ²λ¦¬](#6-μ¤λ¥-μ²λ¦¬)
7. [λ©”μ‹μ§€ ν¬λ§· κ°€μ΄λ“](#7-λ©”μ‹μ§€-ν¬λ§·-κ°€μ΄λ“)

## 1. API μ—”λ“ν¬μΈνΈ κ°μ”

KeywordPulseλ” λ‹¤μκ³Ό κ°™μ€ ν…”λ κ·Έλ¨ κ΄€λ ¨ API μ—”λ“ν¬μΈνΈλ¥Ό μ κ³µν•©λ‹λ‹¤:

| μ—”λ“ν¬μΈνΈ | λ©”μ„λ“ | μ„¤λ… |
|------------|--------|------|
| `/api/notify/telegram/test` | POST | ν…”λ κ·Έλ¨ μ„¤μ • ν…μ¤νΈλ¥Ό μ„ν• λ©”μ‹μ§€ μ „μ†΅ |
| `/api/notify/telegram` | POST | ν‚¤μ›λ“ λ¶„μ„ κ²°κ³Ό μ•λ¦Ό μ „μ†΅ |
| `/api/notify/telegram/rag` | POST | RAG κΈ°λ° μƒμ„Έ λ¶„μ„ κ²°κ³Ό μ „μ†΅ |
| `/api/notify` | POST | ν™κ²½ λ³€μ κΈ°λ° κΈ°λ³Έ μ•λ¦Ό μ „μ†΅ |

## 2. ν…”λ κ·Έλ¨ ν…μ¤νΈ λ©”μ‹μ§€ API

μ‚¬μ©μμ ν…”λ κ·Έλ¨ μ„¤μ •(λ΄‡ ν† ν° λ° μ±„ν… ID)μ΄ μ¬λ°”λ¥΄κ² κµ¬μ„±λμ—λ”μ§€ ν…μ¤νΈν•κΈ° μ„ν• APIμ…λ‹λ‹¤.

### μ—”λ“ν¬μΈνΈ

```
POST /api/notify/telegram/test
```

### μ”μ²­ νλΌλ―Έν„°

| νλΌλ―Έν„° | νƒ€μ… | ν•„μ | μ„¤λ… |
|----------|------|------|------|
| token | string | ν•„μ | ν…”λ κ·Έλ¨ λ΄‡ ν† ν° |
| chat_id | string | ν•„μ | ν…”λ κ·Έλ¨ μ±„ν… ID |
| message | string | ν•„μ | μ „μ†΅ν•  ν…μ¤νΈ λ©”μ‹μ§€ |

### μ”μ²­ μμ‹

```json
{
  "token": "1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  "chat_id": "123456789",
  "message": "μ΄κ²ƒμ€ ν…μ¤νΈ λ©”μ‹μ§€μ…λ‹λ‹¤."
}
```

### μ‘λ‹µ

#### μ„±κ³µ (200 OK)

```json
{
  "success": true,
  "message": "ν…μ¤νΈ λ©”μ‹μ§€κ°€ μ„±κ³µμ μΌλ΅ μ „μ†΅λμ—μµλ‹λ‹¤.",
  "details": {
    "ok": true,
    "result": {
      "message_id": 123,
      "from": { "id": 1234567890, "is_bot": true, "first_name": "YourBot", "username": "your_bot" },
      "chat": { "id": 123456789, "first_name": "User", "type": "private" },
      "date": 1709532345,
      "text": "μ΄κ²ƒμ€ ν…μ¤νΈ λ©”μ‹μ§€μ…λ‹λ‹¤."
    }
  }
}
```

#### μ‹¤ν¨ (400 Bad Request)

```json
{
  "error": "ν•„μ νλΌλ―Έν„°κ°€ λ„λ½λμ—μµλ‹λ‹¤. (token, chat_id, message)"
}
```

#### μ‹¤ν¨ (500 Internal Server Error)

```json
{
  "error": "ν…”λ κ·Έλ¨ API μ¤λ¥: Bad Request: chat not found",
  "details": {
    "ok": false,
    "error_code": 400,
    "description": "Bad Request: chat not found"
  }
}
```

## 3. ν‚¤μ›λ“ λ¶„μ„ μ•λ¦Ό API

ν‚¤μ›λ“ λ¶„μ„ κ²°κ³Ό λλ” μ»¤μ¤ν…€ λ©”μ‹μ§€λ¥Ό ν…”λ κ·Έλ¨μΌλ΅ μ „μ†΅ν•λ” APIμ…λ‹λ‹¤.

### μ—”λ“ν¬μΈνΈ

```
POST /api/notify/telegram
```

### μ”μ²­ νλΌλ―Έν„°

| νλΌλ―Έν„° | νƒ€μ… | ν•„μ | μ„¤λ… |
|----------|------|------|------|
| token | string | ν•„μ | ν…”λ κ·Έλ¨ λ΄‡ ν† ν° |
| chat_id | string | ν•„μ | ν…”λ κ·Έλ¨ μ±„ν… ID |
| keyword | string | μ΅°κ±΄λ¶€ | λ¶„μ„λ ν‚¤μ›λ“ (customMessageκ°€ μ—†λ” κ²½μ° ν•„μ) |
| score | number | μ„ νƒ | ν‚¤μ›λ“ μ μ (0-100) |
| trends | array | μ„ νƒ | ν‚¤μ›λ“ νΈλ λ“ μ •λ³΄ λ°°μ—΄ |
| customMessage | string | μ΅°κ±΄λ¶€ | μ»¤μ¤ν…€ λ©”μ‹μ§€ (keywordκ°€ μ—†λ” κ²½μ° ν•„μ) |

### μ”μ²­ μμ‹ (ν‚¤μ›λ“ λ¶„μ„)

```json
{
  "token": "1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  "chat_id": "123456789",
  "keyword": "μΈκ³µμ§€λ¥",
  "score": 87,
  "trends": [
    {"period": "μΌμ£ΌμΌ", "change": 5},
    {"period": "ν•λ‹¬", "change": -2},
    {"period": "3κ°μ›”", "change": 12}
  ]
}
```

### μ”μ²­ μμ‹ (μ»¤μ¤ν…€ λ©”μ‹μ§€)

```json
{
  "token": "1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  "chat_id": "123456789",
  "customMessage": "<b>μ¤‘μ” μ•λ¦Ό</b>\n\nν‚¤μ›λ“ λ¶„μ„μ΄ μ™„λ£λμ—μµλ‹λ‹¤. μ›Ήμ‚¬μ΄νΈμ—μ„ ν™•μΈν•΄μ£Όμ„Έμ”."
}
```

### μ‘λ‹µ

#### μ„±κ³µ (200 OK)

```json
{
  "success": true,
  "message": "μ•λ¦Όμ΄ μ„±κ³µμ μΌλ΅ μ „μ†΅λμ—μµλ‹λ‹¤.",
  "details": {
    "message_id": 124,
    "date": 1709532400
  }
}
```

## 4. RAG κΈ°λ° λ¶„μ„ μ•λ¦Ό API

RAG(Retrieval Augmented Generation) μ‹μ¤ν…μ„ μ‚¬μ©ν•μ—¬ ν‚¤μ›λ“ λ¶„μ„ κ²°κ³Όλ¥Ό ν…”λ κ·Έλ¨μΌλ΅ μ „μ†΅ν•λ” APIμ…λ‹λ‹¤.

### μ—”λ“ν¬μΈνΈ

```
POST /api/notify/telegram/rag
```

### μ”μ²­ νλΌλ―Έν„°

| νλΌλ―Έν„° | νƒ€μ… | ν•„μ | μ„¤λ… |
|----------|------|------|------|
| token | string | ν•„μ | ν…”λ κ·Έλ¨ λ΄‡ ν† ν° |
| chat_id | string | ν•„μ | ν…”λ κ·Έλ¨ μ±„ν… ID |
| keywords | array | ν•„μ | ν‚¤μ›λ“ λ°μ΄ν„° λ°°μ—΄ |
| templateType | string | μ„ νƒ | ν…ν”λ¦Ώ μ ν• ('basic', 'detailed', 'marketing', κΈ°λ³Έκ°’: 'detailed') |
| maxKeywords | number | μ„ νƒ | ν¬ν•¨ν•  μµλ€ ν‚¤μ›λ“ μ (κΈ°λ³Έκ°’: 5) |
| scoreThreshold | number | μ„ νƒ | μµμ† μ μ μ„κ³„κ°’ (κΈ°λ³Έκ°’: 60) |

### keywords λ°°μ—΄ λ‚΄ κ°μ²΄ κµ¬μ΅°

| μ†μ„± | νƒ€μ… | ν•„μ | μ„¤λ… |
|----------|------|------|------|
| keyword | string | ν•„μ | ν‚¤μ›λ“ ν…μ¤νΈ |
| score | number | ν•„μ | ν‚¤μ›λ“ μ μ (0-100) |
| monthlySearches | number | μ„ νƒ | μ›”κ°„ κ²€μƒ‰λ‰ |
| competitionRate | number | μ„ νƒ | κ²½μλ¥  (0-1) |

### μ”μ²­ μμ‹

```json
{
  "token": "1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  "chat_id": "123456789",
  "keywords": [
    { "keyword": "μΈκ³µμ§€λ¥", "score": 87, "monthlySearches": 12500, "competitionRate": 0.75 },
    { "keyword": "λ¨Έμ‹ λ¬λ‹", "score": 82, "monthlySearches": 8300, "competitionRate": 0.65 },
    { "keyword": "λ”¥λ¬λ‹", "score": 78, "monthlySearches": 6200, "competitionRate": 0.55 },
    { "keyword": "μμ—°μ–΄μ²λ¦¬", "score": 73, "monthlySearches": 4100, "competitionRate": 0.48 },
    { "keyword": "μ»΄ν“¨ν„°λΉ„μ „", "score": 69, "monthlySearches": 3700, "competitionRate": 0.45 }
  ],
  "templateType": "marketing",
  "maxKeywords": 3,
  "scoreThreshold": 75
}
```

### μ‘λ‹µ

#### μ„±κ³µ (200 OK)

```json
{
  "success": true,
  "message": "RAG λ¶„μ„ κ²°κ³Όκ°€ μ„±κ³µμ μΌλ΅ μ „μ†΅λμ—μµλ‹λ‹¤.",
  "keywordCount": 3,
  "templateType": "marketing",
  "details": {
    "message_id": 125,
    "date": 1709532500
  }
}
```

## 5. κΈ°λ³Έ μ•λ¦Ό API

ν™κ²½ λ³€μμ— μ„¤μ •λ ν…”λ κ·Έλ¨ λ΄‡ ν† ν°κ³Ό μ±„ν… IDλ¥Ό μ‚¬μ©ν•μ—¬ μ•λ¦Όμ„ μ „μ†΅ν•λ” APIμ…λ‹λ‹¤.

### μ—”λ“ν¬μΈνΈ

```
POST /api/notify
```

### ν™κ²½ λ³€μ μ„¤μ •

μ΄ APIλ¥Ό μ‚¬μ©ν•λ ¤λ©΄ μ„λ²„μ— λ‹¤μ ν™κ²½ λ³€μκ°€ μ„¤μ •λμ–΄ μμ–΄μ•Ό ν•©λ‹λ‹¤:
- `TELEGRAM_BOT_TOKEN`: ν…”λ κ·Έλ¨ λ΄‡ ν† ν°
- `TELEGRAM_CHAT_ID`: ν…”λ κ·Έλ¨ μ±„ν… ID

### μ”μ²­ νλΌλ―Έν„°

| νλΌλ―Έν„° | νƒ€μ… | ν•„μ | μ„¤λ… |
|----------|------|------|------|
| analysisText | string | ν•„μ | μ „μ†΅ν•  λ¶„μ„ ν…μ¤νΈ |
| format | string | μ„ νƒ | ν¬λ§· μ ν• ('markdown', 'html', κΈ°λ³Έκ°’: 'html') |
| parseMode | string | μ„ νƒ | ν…”λ κ·Έλ¨ νμ‹± λ¨λ“ ('HTML', 'Markdown', 'MarkdownV2', κΈ°λ³Έκ°’: 'HTML') |
| disablePreview | boolean | μ„ νƒ | μ›Ή νμ΄μ§€ λ―Έλ¦¬λ³΄κΈ° λΉ„ν™μ„±ν™” μ—¬λ¶€ |

### μ”μ²­ μμ‹

```json
{
  "analysisText": "**ν‚¤μ›λ“ λ¶„μ„ κ²°κ³Ό**\n\nν‚¤μ›λ“: μΈκ³µμ§€λ¥\nμ μ: 87\n\n*μƒμ„Έ λ‚΄μ©μ€ μ›Ήμ‚¬μ΄νΈμ—μ„ ν™•μΈν•μ„Έμ”.*",
  "format": "markdown",
  "disablePreview": true
}
```

### μ‘λ‹µ

#### μ„±κ³µ (200 OK)

```json
{
  "success": true,
  "messageId": "126"
}
```

#### μ‹¤ν¨ (500 Internal Server Error)

```json
{
  "success": false,
  "error": "TELEGRAM_BOT_TOKEN λλ” TELEGRAM_CHAT_ID ν™κ²½λ³€μκ°€ μ„¤μ •λμ§€ μ•μ•μµλ‹λ‹¤."
}
```

## 6. μ¤λ¥ μ²λ¦¬

λ¨λ“  API νΈμ¶μ€ λ‹¤μκ³Ό κ°™μ€, κ³µν†µμ μΈ μ¤λ¥ μ‘λ‹µ ν•μ‹μ„ κ°€μ§‘λ‹λ‹¤:

```json
{
  "error": "μ¤λ¥ λ©”μ‹μ§€",
  "details": { /* μ¶”κ°€ μ¤λ¥ μ •λ³΄ (μµμ…) */ }
}
```

### μΌλ°μ μΈ μ¤λ¥ μ½”λ“

| HTTP μƒνƒ μ½”λ“ | μ„¤λ… |
|--------------|------|
| 400 | μλ»λ μ”μ²­ (ν•„μ νλΌλ―Έν„° λ„λ½, μλ»λ ν•μ‹ λ“±) |
| 500 | μ„λ²„ μ¤λ¥ (ν…”λ κ·Έλ¨ API ν†µμ‹  μ‹¤ν¨, λ‚΄λ¶€ μ¤λ¥ λ“±) |

## 7. λ©”μ‹μ§€ ν¬λ§· κ°€μ΄λ“

### HTML ν•μ‹ νƒκ·Έ

ν…”λ κ·Έλ¨ λ©”μ‹μ§€μ—μ„ μ§€μ›ν•λ” HTML ν•μ‹ νƒκ·Έ:

- `<b>...</b>`: κµµμ€ ν…μ¤νΈ
- `<i>...</i>`: κΈ°μΈμ„κΌ΄ ν…μ¤νΈ
- `<code>...</code>`: κ³ μ •ν­ ν…μ¤νΈ
- `<pre>...</pre>`: ν•μ‹μ΄ μ§€μ •λ κ³ μ •ν­ ν…μ¤νΈ λΈ”λ΅
- `<a href="...">...</a>`: λ§ν¬
- `<s>...</s>`: μ·¨μ†μ„ 
- `<u>...</u>`: λ°‘μ¤„

### λ§ν¬λ‹¤μ΄ ν•μ‹ μ‚¬μ© μ‹ μ£Όμμ‚¬ν•­

λ§ν¬λ‹¤μ΄ ν•μ‹μ„ μ‚¬μ©ν•  λ•λ” λ‹¤μ λ¬Έμλ¥Ό μ΄μ¤μΌ€μ΄ν”„ μ²λ¦¬ν•΄μ•Ό ν•©λ‹λ‹¤:
`_`, `*`, `[`, `]`, `(`, `)`, `~`, `` ` ``, `>`, `#`, `+`, `-`, `=`, `|`, `{`, `}`, `.`, `!`

μ: `\*ν…μ¤νΈ\*` -> `*ν…μ¤νΈ*`

### μ΄λ¨μ§€ μ‚¬μ©

μ΄λ¨μ§€λ” λ©”μ‹μ§€μ— μ§μ ‘ ν¬ν•¨ν•κ±°λ‚ Unicode ν¬μΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ ν¬ν•¨ν•  μ μμµλ‹λ‹¤:

- π“ - μ°¨νΈ
- π“ - μƒμΉ μ°¨νΈ
- π“‰ - ν•λ½ μ°¨νΈ
- π” - κ²€μƒ‰
- β οΈ - κ²½κ³ 
- β… - ν™•μΈ
- β - μ¤λ¥ 